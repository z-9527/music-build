{"version":3,"sources":["components/Loading/index.js","components/Loading/style/index.module.less","pages/MVPage/style/index.module.less","pages/MVPage/index.js"],"names":["Loading","matchingType","type","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","style","_this$props","this","props","loading","React","Component","defaultProps","module","exports","loading-box","line-scale","ball-clip-rotate-multiple","rotate","ball-clip-rotate-pulse","scale","square-spin","ball-scale","ball-scale-multiple","container","navbar","iconfont","content","title","desc","comment-section","left","right","user-box","time","comment","MVPage","withRouter","state","mvData","comments","hotComments","total","isLoadMore","initPage","_this","setState","id","match","params","Promise","all","getMvData","getComments","then","_callee","res","_Users_one_Desktop_Demo_music_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","wrap","_context","prev","next","get","concat","sent","data","stop","goBack","history","_callee2","_context2","onLoadMore","_callee3","_context3","abrupt","offset","length","scroll","finishPullUp","_this2","_this$state","react__WEBPACK_IMPORTED_MODULE_7___default","onClick","video_react__WEBPACK_IMPORTED_MODULE_12__","src","brs","poster","cover","position","height","display","_components_Scroll_index__WEBPACK_IMPORTED_MODULE_15__","onPullingUp","ref","el","name","color","publishTime","formatNumber","playCount","dangerouslySetInnerHTML","createMarkup","map","item","key","commentId","user","avatarUrl","alt","nickname","likedCount","dayjs","format","_components_Loading__WEBPACK_IMPORTED_MODULE_16__","top"],"mappings":"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","file":"static/js/11.2c0b821b.chunk.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport style from './style/index.module.less'\n\nclass Loading extends React.Component {\n    static propTypes = {\n        type: PropTypes.string,\n        loading: PropTypes.bool,\n        style: PropTypes.object\n    }\n    static defaultProps = {\n        style: {}\n    }\n    matchingType = (type) => {\n        switch (type) {\n            case 'line-scale': {\n                return (\n                    <div className={style['line-scale']}>\n                        <div/>\n                        <div/>\n                        <div/>\n                        <div/>\n                        <div/>\n                    </div>\n                )\n            }\n            case 'ball-clip-rotate-multiple': {\n                return (\n                    <div className={style['ball-clip-rotate-multiple']}>\n                        <div/>\n                        <div/>\n                    </div>\n                )\n            }\n            case 'ball-clip-rotate-pulse': {\n                return (\n                    <div className={style['ball-clip-rotate-pulse']}>\n                        <div/>\n                        <div/>\n                    </div>\n                )\n            }\n            case 'square-spin': {\n                return (\n                    <div className={style['square-spin']}>\n                        <div/>\n                    </div>\n                )\n            }\n            case 'ball-scale': {\n                return (\n                    <div className={style['ball-scale']}>\n                        <div/>\n                    </div>\n                )\n            }\n            case 'ball-scale-multiple': {\n                return (\n                    <div className={style['ball-scale-multiple']}>\n                        <div/>\n                        <div/>\n                        <div/>\n                    </div>\n                )\n            }\n            default:\n                return (\n                    <div className={style['line-scale']}>\n                        <div/>\n                        <div/>\n                        <div/>\n                        <div/>\n                        <div/>\n                    </div>\n                )\n        }\n    }\n\n    render () {\n        const {type, loading} = this.props\n        return loading ? (\n            <div className={style['loading-box']} style={this.props.style}>\n                {this.matchingType(type)}\n            </div>\n        ) : null\n    }\n}\n\nexport default Loading","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-box\":\"index_loading-box__1Kgdg\",\"line-scale\":\"index_line-scale__1_OJc\",\"ball-clip-rotate-multiple\":\"index_ball-clip-rotate-multiple__3iegK\",\"rotate\":\"index_rotate__mxK17\",\"ball-clip-rotate-pulse\":\"index_ball-clip-rotate-pulse__2h6Nk\",\"scale\":\"index_scale__3JsNk\",\"square-spin\":\"index_square-spin__37Em9\",\"ball-scale\":\"index_ball-scale__16fEH\",\"ball-scale-multiple\":\"index_ball-scale-multiple__1jdW_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"index_container__Oc7o_\",\"loading\":\"index_loading__3B3g9\",\"navbar\":\"index_navbar__2V3NH\",\"iconfont\":\"index_iconfont__16KBr\",\"content\":\"index_content__1Pq7a\",\"title\":\"index_title__2Z7JN\",\"desc\":\"index_desc__1e42m\",\"comment-section\":\"index_comment-section__2XkMz\",\"left\":\"index_left__1MS6K\",\"right\":\"index_right__3LcyX\",\"user-box\":\"index_user-box__2iiR3\",\"time\":\"index_time__2qamI\",\"comment\":\"index_comment__CgAKH\"};","import React from 'react'\nimport style from './style/index.module.less'\nimport {get} from '@/utils/ajax'\nimport {withRouter} from 'react-router-dom'\nimport 'video-react/dist/video-react.css';\nimport { Player,BigPlayButton } from 'video-react';\nimport {formatNumber,createMarkup} from '@/utils/util'\nimport dayjs from 'dayjs'\nimport Scroll from '../../components/Scroll/index'\nimport Loading from '@/components/Loading'\n\n@withRouter\nclass MVPage extends React.Component{\n    state = {\n        mvData:{},  //mv数据\n        comments:[], //mv评论\n        hotComments:[], //热门评论\n        total:0, //所有评论\n        isLoadMore:false, //是否正在\"加载更多\"\n        loading:false //页面loading\n    }\n    componentDidMount(){\n        this.initPage()\n    }\n    initPage = ()=>{\n        this.setState({\n            loading:true\n        })\n        const id = this.props.match.params.id\n        Promise.all([\n            this.getMvData(id),\n            this.getComments(id)\n        ]).then(()=>{\n            this.setState({\n                loading:false\n            })\n        })\n    }\n    getMvData = async (id)=>{\n        const res = await get(`/mv/detail?mvid=${id}`)\n        this.setState({\n            mvData:res.data || {}\n        })\n    }\n    goBack = ()=>{\n        this.props.history.goBack()\n    }\n    getComments = async (id)=>{\n        const res = await get(`/comment/mv?id=${id}`)\n        this.setState({\n            comments:res.comments || [],\n            hotComments:res.hotComments || [],\n            total:res.total || 0\n        })\n    }\n    onLoadMore = async()=>{\n        if(this.state.isLoadMore){\n            return\n        }\n        this.setState({\n            isLoadMore:true\n        })\n        const id = this.props.match.params.id\n        const res = await get(`/comment/mv`,{\n            id,\n            offset:this.state.comments.length\n        })\n        this.setState({\n            isLoadMore:false,\n            comments:this.state.comments.concat(res.comments || [])\n        })\n        this.scroll && this.scroll.finishPullUp()\n    }\n    render(){\n        const {mvData,hotComments,comments,total,isLoadMore,loading} = this.state\n        return (\n            <div className={style.container}>\n                <div className={style.navbar}>\n                    <div className={`iconfont icon-zuojiantou ${style.iconfont}`} onClick={this.goBack}/>\n                    <div className={style.title}>MV</div>\n                </div>\n                <div>\n                    <Player src={mvData.brs && mvData.brs[240]} poster={mvData.cover}>\n                        <BigPlayButton position=\"center\" />\n                    </Player>\n                </div>\n                <div style={{height:'calc(100vh - 256px)',display:loading?'none':''}}>\n                    <Scroll onPullingUp={this.onLoadMore} ref={el=>this.scroll=el}>\n                        <div>\n                            <div className={style.content}>\n                                <div className={style.title}>{mvData.name}</div>\n                                <div style={{color:'#555'}}>发布：{mvData.publishTime} &nbsp; | &nbsp; 播放：{formatNumber(mvData.playCount)}</div>\n                                <div dangerouslySetInnerHTML={createMarkup(mvData.desc)} className={style.desc}/>\n                            </div>\n                            <div className={style['comment-section']}>\n                                <div className={style.title}>精彩评论</div>\n                                <ul>\n                                    {hotComments && hotComments.map(item=><li key={item.commentId}>\n                                        <div className={style.left}>\n                                            <img src={item.user && item.user.avatarUrl} alt=\"\"/>\n                                        </div>\n                                        <div className={style.right}>\n                                            <div className={style['user-box']}>\n                                                <div>{item.user && item.user.nickname}</div>\n                                                <div>{item.likedCount} <span className={'iconfont icon-zan1'}/></div>\n                                            </div>\n                                            <div className={style.time}>{dayjs(item.time).format('M[月]D[日]')}</div>\n                                            <div className={style.comment}>{item.content}</div>\n                                        </div>\n                                    </li>)}\n                                </ul>\n                            </div>\n                            <div className={style['comment-section']}>\n                                <div className={style.title}>最新评论({total})</div>\n                                <ul>\n                                    {comments && comments.map(item=><li key={item.commentId}>\n                                        <div className={style.left}>\n                                            <img src={item.user && item.user.avatarUrl} alt=\"\"/>\n                                        </div>\n                                        <div className={style.right}>\n                                            <div className={style['user-box']}>\n                                                <div>{item.user && item.user.nickname}</div>\n                                                <div>{item.likedCount ? item.likedCount : null} <span className={'iconfont icon-zan1'}/></div>\n                                            </div>\n                                            <div className={style.time}>{dayjs(item.time).format('M[月]D[日]')}</div>\n                                            <div className={style.comment}>{item.content}</div>\n                                        </div>\n                                    </li>)}\n                                </ul>\n                                <div className={style.loading} style={{display:isLoadMore?'':'none'}}>加载中...</div>\n                            </div>\n                        </div>\n                    </Scroll>\n                </div>\n                <Loading loading={loading} style={{top:'60%'}}/>\n            </div>\n        )\n    }\n}\n\nexport default MVPage"],"sourceRoot":""}